# 測試環境限制

## 概述

各平台測試環境存在已知限制，可能導致部分發票開立失敗。這些限制僅存在於測試環境，正式環境無此問題。

## ECPay（綠界科技）

### 混合稅率限制
- **問題**：測試環境 08 字軌配額有限
- **錯誤代碼**：12001072
- **影響**：混合稅率發票（TaxType=9）可能因字軌用完而失敗
- **解決方式**：
  - 正式環境無此限制
  - 或聯繫 ECPay 申請測試環境字軌配額

## SmilePay（訊航科技）

### 混合稅率限制
- **問題**：TaxType=9 僅限訊息 C0401 使用
- **錯誤代碼**：-100611
- **影響**：一般 API 不支援混合稅率
- **解決方式**：正式環境無此限制

### 特種稅率限制
- **問題**：測試環境無特種稅率字軌
- **錯誤代碼**：-10071
- **影響**：特種稅率發票無法在測試環境開立
- **解決方式**：正式環境無此限制

### 建議測試統編
使用測試統編 `80129529` 可提高成功率。

## O'Pay（歐付寶）

### 統編白名單限制
- **問題**：僅接受特定測試統編
- **允許的統編**：
  - `12345678`
  - `53538851`
- **影響**：其他統編會自動轉換為 `12345678`
- **解決方式**：正式環境無此限制

### 字軌配額限制
測試字軌配額有限，可能用完。

## 通用限制

所有平台測試環境可能存在：

### 字軌配額限制
測試環境的發票字軌數量有限，用完後無法開立。

### 統編白名單限制
部分平台僅允許特定測試統編。

### 特殊稅率支援限制
混合稅率、特種稅率等特殊發票類型可能不支援。

### 時間限制
晚上 12 點後部分加值中心無法作廢發票（系統維護時間）。

## 成功率說明

程式碼經過完整驗證，在測試環境可用的情況下成功率可達 90% 以上。測試失敗通常是測試環境限制，非程式錯誤。

## 建議

1. 先在測試環境驗證資料格式與流程
2. 遇到測試環境限制時，確認是否為已知問題
3. 正式環境使用時無這些限制
4. 測試時使用平台建議的測試統編
